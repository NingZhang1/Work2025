import pyscf
from pyscf import scf, tools
import numpy
from pyscf_util.File.file_cmoao import ReadIn_Cmoao
from pyscf_util.misc.orb_comp_analysis import Analysis_MO_Component, print_dict_as_table

GEOMETRY = """
Fe       0.000000        0.000000        0.000000
N1        3.734855       -0.000000        0.000000
N2       -0.000000        0.000000       -3.757531
N3       -3.734855        0.000000        0.000000
N4        0.000000        0.000000        3.757531
C21        5.325626       -0.000000        2.060368
C22        5.325626       -0.000000       -2.060368
C3        2.063203       -0.000000       -5.338287
C4       -2.063203        0.000000       -5.338287
C5       -5.325626        0.000000       -2.060368
C6       -5.325626        0.000000        2.060368
C7       -2.063203        0.000000        5.338287
C8        2.063203       -0.000000        5.338287
C9        7.929480       -0.000000        1.279912
C10        7.929480       -0.000000       -1.279912
C11        1.289738       -0.000000       -7.920220
C12      -1.289738        0.000000       -7.920220
C13       -7.929480        0.000000       -1.279912
C14       -7.929480        0.000000        1.279912
C15       -1.289738        0.000000        7.920220
C16        1.289738       -0.000000        7.920220
H21        9.531968       -0.000000        2.558311
H22        9.531968       -0.000000       -2.558311
H3        2.562091       -0.000000       -9.527243
H4       -2.562091        0.000000       -9.527243
H5       -9.531968        0.000000       -2.558311
H6       -9.531968        0.000000        2.558311
H7       -2.562091        0.000000        9.527243
H8        2.562091       -0.000000        9.527243
C17       4.563689       -0.000000       -4.551027
C18      -4.563689        0.000000       -4.551027
C19       -4.563689        0.000000        4.551027
C20        4.563689       -0.000000        4.551027
H9        6.019723       -0.000000       -6.000258
H10       -6.019723        0.000000       -6.000258
H11       -6.019723        0.000000        6.000258
H12        6.019723       -0.000000        6.000258
"""

# ROHF #

Mol = pyscf.gto.Mole()
Mol.atom = GEOMETRY
Mol.basis = "cc-pvdz"
Mol.symmetry = True
Mol.spin = 4
Mol.charge = 0
Mol.verbose = 4
Mol.unit = "bohr"
Mol.build()

fep_rohf = ReadIn_Cmoao("FeP_ROHF", Mol.nao, Mol.nao)

# first (186 - 4) // 2 + 4 = 95 orbitals

# basis = {
#     "Fe":"cc-pvdz",
#     "C":"cc-pvdz",
#     "N":"cc-pvdz",
#     "H":"cc-pvdz",
# }

res = Analysis_MO_Component(
    Mol, fep_rohf, numpy.zeros(Mol.nao), 95 + 30, "cc-pvdz", with_sfx2c=False
)

print(print_dict_as_table(res))
